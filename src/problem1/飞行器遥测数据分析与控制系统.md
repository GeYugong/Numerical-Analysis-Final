


## 1. 实验背景与任务目标

本实验针对一架在返回阶段遭遇强电磁干扰的试验飞行器，旨在解决其轨迹数据丢失、运动模型未知及姿态控制参数需要重新校准的问题。主要任务包括四个阶段：

1. **数据恢复**：利用插值算法填补 $t=6s$ 至 $t=8s$ 期间因丢包导致的高度数据缺失。
    
2. **模型构建与回归**：基于物理运动规律，对比线性模型与二次模型，利用最小二乘法建立最优运动方程。
    
3. **落地时间预测**：利用非线性方程求根算法（牛顿法），预测飞行器的理论落地时间。
    
4. **推力解算**：利用线性方程组迭代解法（SOR法），计算姿态控制引擎的推力分配。
    

---

## 2. 实验原理与结果分析

### 2.1 数据恢复（分段拉格朗日插值）

原理与策略：

由于数据在 $t=6, 7, 8$ 时刻连续丢失，且两端数据包含传感器噪声。为了避免高次插值带来的龙格现象，本实验采取局部低次插值策略，而非对全局数据进行插值。

- 利用 $t \in \{4, 5, 9\}$ 的数据点构造二次拉格朗日多项式，插值计算 $t=6, 7$ 的高度。
    
- 利用 $t \in \{5, 9, 10\}$ 的数据点构造二次拉格朗日多项式，插值计算 $t=8$ 的高度。
    

计算结果：

程序运行输出如下，成功填补了缺失数据：

- $t=6$: **499.87 m**
    
- $t=7$: **495.21 m**
    
- $t=8$: **481.45 m**
    

---

### 2.2 模型构建与回归分析（线性 vs 二次）

原理与论证：

物理学运动学公式指出，在忽略空气阻力巨变的情况下，垂直运动高度 $h$ 与时间 $t$ 应满足二次函数关系 $h(t) = at^2 + bt + c$。为了验证这一假设并消除噪声影响，我们分别尝试了线性拟合 ($h=bt+c$) 和 二次拟合 ($h=at^2+bt+c$)，并使用均方误差 (MSE) 作为评价指标。

$$MSE = \frac{1}{m} \sum_{i=1}^{m} (y_i - \hat{y}_i)^2$$

**对比结果：**

- **线性模型 MSE**: $6893.95$
    
- **二次模型 MSE**: $0.623816$
    

**结论：**

1. **数据实证**：二次模型的 MSE ($0.62$) 远小于线性模型 ($6894$)，说明数据具有显著的非线性特征。
    
2. **物理一致性**：二次拟合得到的二次项系数 $a \approx -5.006$，近似等于 $-g/2$（重力加速度的一半），符合自由落体物理规律。
    

最终模型：

$$h(t) = -5.00646 t^2 + 60.1232 t + 319.697$$

---

### 2.3 落地时间预测（牛顿迭代法）

原理：

落地时间即满足 $h(t)=0$ 的时刻。我们使用牛顿迭代法求解该非线性方程。迭代公式为：

$$t_{k+1} = t_k - \frac{h(t_k)}{h'(t_k)}$$

其中导数 $h'(t) = 2at + b$。

算法选择分析：

本实验不适合使用二分法。因为已知数据范围为 $t \in [0, 14]$，在此范围内高度 $h(t)$ 始终为正值（$t=14$ 时 $h \approx 178.9$）。根位于已知数据范围之外，无法直接找到符号改变的区间 $[a, b]$，因此利用导数信息进行外推的牛顿法是更优选择。

计算结果：

以 $t_0 = 14$ 为初值，算法快速收敛，预测落地时间为：

$$t \approx 16.000145 \text{ s}$$

![](../images/aircraft.png)
---

### 2.4 引擎推力解算（SOR 迭代法）

原理：

针对姿态控制引擎的推力平衡方程组 $Ax=b$：

$$\begin{cases} 4x_1 + 3x_2 = 24 \\ 3x_1 + 4x_2 - x_3 = 30 \\ -x_2 + 4x_3 = -24 \end{cases}$$

采用超松弛迭代法 (SOR) 求解。相较于 Gauss-Seidel 迭代，SOR 引入松弛因子 $\omega$ 以加速收敛。

**参数设置：**

- 松弛因子 $\omega = 1.25$
    
- 初始猜测 $\mathbf{x}_0 = (1, 1, 1)^T$
    
- 容差 $tol = 10^{-6}$
    

计算结果：

算法在 13 次迭代后满足收敛条件，解得：

$$\mathbf{x} = [3.000000, 4.000000, -5.000000]^T$$

---

## 3. 附加题：龙格现象 (Runge's Phenomenon) 分析

实验内容：

对函数 $f(x) = \frac{1}{1+25x^2}$ 在区间 $[-5, 5]$ 上, 分别使用 **四种插值方法**: 拉格朗日插值, 多项式 Newton, 分段线性, 三次样条插值, 在节点数 $n = 2, 4, 6, 8, 10$ (等距节点数) 下比较误差表现.

数据对比：(最大误差 $|R_n(x)|$):

| **节点数 n** | **Lagrange** | **Newton**   | **分段线性**     | **三次样条插值**   | **现象描述**                                 |
| --------- | ------------ | ------------ | ------------ | ------------ | ---------------------------------------- |
| 2         | 0.921602     | 0.921602     | 0.784752     | 0.907330     | 拉格朗日插值和牛顿插值使用相同的多项式；分段插值和样条插值使用的多项式次数较低。 |
| 4         | 0.830711     | 0.830711     | 0.664611     | 0.793144     | 所有方法的错误率均略有下降。                           |
| 6         | 0.978502     | 0.978502     | 0.568884     | 0.700950     | 全球多边形误差开始上升；其他误差保持在适度水平。                 |
| 8         | 2.233138     | 2.233138     | 0.487988     | 0.619689     | 对于全局多项式插值，龙格振荡会加剧；分段插值/样条插值则比较稳定。        |
| 10        | **5.791053** | **5.791053** | **0.417308** | **0.545754** | 全局多项式拟合结果波动较大；分段拟合结果最低，样条拟合结果稳定。         |

**结论讨论**：

1. **拉格朗日插值 / Newton(全局多项式)**: Newton 与 拉格朗日插值 生成的多项式一致; 随 $n$ 增加在区间边缘出现强烈振荡, 典型龙格现象.
2. **分段线性插值**: 误差随节点数增加单调下降, 数值稳定但精度受限.
3. **三次样条插值**: 误差随节点数增加稳步下降, 兼顾平滑与稳定性.
4. **总结**: 在等距节点数上, 高阶全局多项式容易出现龙格现象; 分段线性方法(线性/三次样条插值) 更优于稳健.

![](../images/Runge%20phenomenon_new.png)
---

## 4. 实验总结

本次实验完全基于 C++ 自主实现了数值分析核心算法库 `NumCpp`（未使用第三方库），完成了从底层数据结构设计到上层复杂计算的全流程。

1. **工程实现**：设计了清晰的矩阵运算类与求解器接口，实现了高斯消元、LU分解及 SOR 迭代。
    
2. **算法验证**：
    
    - 通过对比 MSE，科学论证了二次回归模型的合理性。
        
    - 牛顿法与 SOR 法均给出了高精度的数值解。
        
    - 通过对比四种插值算法，直观展示了龙格现象的危害及样条插值的优势。
        



---

## 附录：程序运行结果

_(注：以下为程序 `src/problem1/main.cpp` 的实际输出内容)_

```Plaintext
--- [步骤 1] 数据恢复 (插值算法) ---
恢复 t=6: 499.87
恢复 t=7: 495.21
恢复 t=8: 481.45
数据恢复完成。

--- [步骤 2] 模型构建与回归 (多项式拟合对比) ---
模型对比结果 (MSE):
  线性模型   MSE: 6893.95
  二次模型   MSE: 0.623816

论证结论：
  数据显示二次模型的均方误差 (MSE) 显著小于线性模型。
  结合物理学原理 (h=at^2+bt+c)，二次模型更适合。
最终拟合函数表达式: h(t) = -5.00646 * t^2 + 60.1232 * t + 319.697

--- [步骤 3] 落地时间预测 ---
预测落地时间 (h=0): 16.000145 秒

--- [步骤 4] 引擎推力控制 (SOR 方法) ---
SOR 迭代收敛于 13 次迭代。
引擎推力解: x1=3.000000, x2=4.000000, x3=-5.000000


   正在运行附加题：龙格现象分析


n     Lagrange误差 Newton误差   分段线性误差三次样条误差
----------------------------------------------------------------------
2     0.921602       0.921602       0.784752       0.907330
4     0.830711       0.830711       0.664611       0.793144
6     0.978502       0.978502       0.568884       0.700950
8     2.233138       2.233138       0.487988       0.619689
10    5.791053       5.791053       0.417308       0.545754
```